#### 3-1 数据库实现 - 物理存储结构

1. 物理存储介质

   高速缓存、主存、闪存、磁盘、光盘、磁带

2. 磁盘

   1. 磁盘组、磁道、扇区（磁盘块、页）、柱面
   2. 磁盘驱动、磁头、磁臂
   3. 与主存以（磁盘块）页为单位交换
   4. 寻址：盘面、柱面、扇区
   5. 寻道时间+旋转延迟+传输延迟

3. 磁盘缓冲技术

   1. 在主存中设置多个缓冲区，每个缓冲区大小为一块（页），处理一个块的时候读下一个块。
   2. 每个缓冲块有：dirty和pin_count两个值。
      dirty表示是否被修改，需要写回。
      pin_count为当前正在使用该块的事务计数
   3. 缓冲区满需要选块被替换，选择pin_count=0的，如果没有，则放弃事务，否则根据策略选择一个：LRU、MRU、立即丢弃（用完就写回）等。
   4. 事务处理策略
      1. 先来先服务
      2. 近者优先：优先处理离磁头最近的
      3. 全程移动扫描：扫描磁道，从0到最大顺序循环处理
      4. 移动扫描：扫描磁道，前进方向没有请求则反向。
      5. 分组扫描：按照分组
      6. 间歇式扫描：每个柱面停止等待磁盘旋转n次。

4. 磁盘容错技术（RAID）

   1. RAID1：每个磁盘一个冗余盘，数据同步。
   2. RAID4：多个磁盘一个冗余盘，只存奇偶校验位。某个磁盘坏了通过其他磁盘数据可以推出。
   3. RAID5：4的冗余盘容易坏，改成每个磁盘若干扇区存奇偶校验位。

5. 文件和关系

   1. 数据项——属性值（及其类型）

   2. 文件记录——元组（可选定长/非定长、可选允许跨块存储）

   3. 文件块（磁盘块）——多个元组

      记录固定的文件块：直接指针，修改复杂

      非固定记录的文件块：2级间接指针，修改快。

   4. 文件——关系

      存储方法：连续（磁盘块）、连接（链表）、索引。

6. 简单HASH文件

   1. 用散列函数计算指定的哈希属性，得到哈希值，查表，放入表项对应磁盘块中，如果不够，新建磁盘块，旧磁盘块指向下一个新的磁盘块。
   2. 查找：哈希属性算值查表，否则全表查询
   3. 插入：如1.
   4. 删除：已知hash值，反向1，释放磁盘块。否则全表查询。
   5. 缺点：哈希函数不变，文件记录增多，效率降低。对较少文件记录的关系，浪费空间。

7. 动态HASH文件：

   1. 可扩展Hash文件

   